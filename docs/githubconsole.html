<!DOCTYPE html>  <html> <head>   <title>githubconsole.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               githubconsole.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="cm">/*------------------------------------------------------------------------*</span>
<span class="cm"> * Copyright 2013 Arne F. Claassen</span>
<span class="cm"> *</span>
<span class="cm"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="cm"> * you may not use this file except in compliance with the License.</span>
<span class="cm"> * You may obtain a copy of the License at</span>
<span class="cm"> *</span>
<span class="cm"> *   http://www.apache.org/licenses/LICENSE-2.0</span>

<span class="cm"> * Unless required by applicable law or agreed to in writing, software</span>
<span class="cm"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="cm"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="cm"> * See the License for the specific language governing permissions and</span>
<span class="cm"> * limitations under the License.</span>
<span class="cm"> *-------------------------------------------------------------------------*/</span>
<span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="nx">$</span><span class="p">,</span> <span class="nx">_</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">Josh</span><span class="p">.</span><span class="nx">GitHubConsole</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="nx">$</span><span class="p">,</span> <span class="nx">_</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Enable console debugging, when Josh.Debug is set and there is a console object on the document root.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">_console</span> <span class="o">=</span> <span class="p">(</span><span class="nx">Josh</span><span class="p">.</span><span class="nx">Debug</span> <span class="o">&amp;&amp;</span> <span class="nx">root</span><span class="p">.</span><span class="nx">console</span><span class="p">)</span> <span class="o">?</span> <span class="nx">root</span><span class="p">.</span><span class="nx">console</span> <span class="o">:</span> <span class="p">{</span>
      <span class="nx">log</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="p">}</span>
    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <h1>Console State</h1>

<p><code>_self</code> contains all state variables for the console's operation</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">_self</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">shell</span><span class="o">:</span> <span class="nx">Josh</span><span class="p">.</span><span class="nx">Shell</span><span class="p">({</span><span class="nx">console</span><span class="o">:</span> <span class="nx">_console</span><span class="p">}),</span>
      <span class="nx">api</span><span class="o">:</span> <span class="s2">&quot;http://josh.claassen.net/github/&quot;</span>
    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p><code>Josh.PathHandler</code> is attached to <code>Josh.Shell</code> to provide basic file system navigation.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_self</span><span class="p">.</span><span class="nx">pathhandler</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Josh</span><span class="p">.</span><span class="nx">PathHandler</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">,</span> <span class="p">{</span><span class="nx">console</span><span class="o">:</span> <span class="nx">_console</span><span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <h1>Custom Templates</h1>

<p><code>Josh.Shell</code> uses <em>Underscore</em> templates for rendering output to the shell. This console overrides some and adds a couple of new ones for its own commands.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p><strong>templates.prompt</strong></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Override of the default prompt to provide a multi-line prompt of the current user, repo and path and branch.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">prompt</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="s2">&quot;&lt;em&gt;[&lt;%= self.user.login %&gt;/&lt;%= self.repo.name %&gt;]&lt;/em&gt;&lt;/br&gt;(&lt;%=self.branch%&gt;) &lt;strong&gt;&lt;%= node.path %&gt; $&lt;/strong&gt;&quot;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p><strong>templates.ls</strong></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Override of the pathhandler ls template to create a multi-column listing.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">ls</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="s2">&quot;&lt;ul class=&#39;widelist&#39;&gt;&lt;% _.each(nodes, function(node) { %&gt;&lt;li&gt;&lt;%- node.name %&gt;&lt;/li&gt;&lt;% }); %&gt;&lt;/ul&gt;&lt;div class=&#39;clear&#39;/&gt;&quot;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p><strong>templates.not_found</strong></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Override of the pathhandler <em>not_found</em> template, since we will throw <em>not_found</em> if you try to access a valid file. This is done for the simplicity of the tutorial.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">not_found</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;&lt;%=cmd%&gt;: &lt;%=path%&gt;: No such directory&lt;/div&gt;&quot;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p><strong>templates.rateLimitTemplate</strong></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Since GitHub rate limits un-authenticated use rather drastically, we render the current rate limit status in the shell so that it is clear that extended experimenting requires authentication.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">rateLimitTemplate</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="s2">&quot;&lt;%=remaining%&gt;/&lt;%=limit%&gt;&lt;% if(!authenticated) {%&gt; &lt;a href=&#39;http://josh.claassen.net/github/authenticate&#39;&gt;Authenticate with Github to increase your Rate Limit.&lt;/a&gt;&lt;%}%&gt;&quot;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p><strong>templates.user</strong></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Render basic information (including gravatar) whenever we switch users or enter <code>user</code> without an argument</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">user</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="s2">&quot;&lt;div class=&#39;userinfo&#39;&gt;&quot;</span> <span class="o">+</span>
      <span class="s2">&quot;&lt;img src=&#39;&lt;%=user.avatar_url%&gt;&#39; style=&#39;float:right;&#39;/&gt;&quot;</span> <span class="o">+</span>
      <span class="s2">&quot;&lt;table&gt;&quot;</span> <span class="o">+</span>
      <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Id:&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;&lt;%=user.id %&gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span> <span class="o">+</span>
      <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Name:&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;&lt;%=user.login %&gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span> <span class="o">+</span>
      <span class="s2">&quot;&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Location:&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;&lt;%=user.location %&gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span> <span class="o">+</span>
      <span class="s2">&quot;&lt;/table&gt;&quot;</span> <span class="o">+</span>
      <span class="s2">&quot;&lt;/div&gt;&quot;</span>
    <span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p><strong>templates.user_error</strong></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>Generic error in case setting the user fails.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">user_error</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="s2">&quot;Unable to set user &#39;&lt;%=name%&gt;&#39;: &lt;%=msg%&gt;&quot;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p><strong>templates.repos</strong></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Just like <code>ls</code>, we render a wide list of repositories for <code>repo -l</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">repos</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="s2">&quot;&lt;ul class=&#39;widelist&#39;&gt;&lt;% _.each(repos, function(repo) { %&gt;&lt;li&gt;&lt;%- repo.name %&gt;&lt;/li&gt;&lt;% }); %&gt;&lt;/ul&gt;&lt;div class=&#39;clear&#39;/&gt;&quot;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p><strong>template.repo</strong></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Whenever we change repositories or <code>repo</code> is called without an argument, we show basic information about the repo.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">repo</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;&lt;div&gt;&lt;strong&gt;Name: &lt;/strong&gt;&lt;%=repo.full_name%&gt;&lt;/div&gt;&lt;div&gt;&lt;strong&gt;Description: &lt;/strong&gt;&lt;%=repo.description %&gt;&lt;/div&gt;&lt;/div&gt;&quot;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p><strong>template.repo<em>not</em>found</strong></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>Error message in case someone tries to switch to an invalid repo.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">repo_not_found</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;repo: &lt;%=repo%&gt;: No such repo for user &#39;&lt;%= user %&gt;&#39;&lt;/div&gt;&quot;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p><strong>templates.repo_error</strong></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>Generic error message in case setting the repo fails.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">repo_error</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="s2">&quot;Unable to switch to repository &#39;&lt;%=name%&gt;&#39;: &lt;%=msg%&gt;&quot;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p><strong>templates.branches</strong></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>Again, like <code>ls</code>, we render a wide like of branches for <code>branch -l</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">branches</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="s2">&quot;webfont.woff&lt;ul class=&#39;widelist&#39;&gt;&lt;% _.each(branches, function(branch) { %&gt;&lt;li&gt;&lt;%- branch.name %&gt;&lt;/li&gt;&lt;% }); %&gt;&lt;/ul&gt;&lt;div class=&#39;clear&#39;/&gt;&quot;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p><strong>templates.branch_error</strong></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>Generic error message in case setting the current branch fails.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">branch_error</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="s2">&quot;Unable to switch to branch &#39;&lt;%=name%&gt;&#39;: &lt;%=msg%&gt;&quot;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p><strong>templates.branches_error</strong></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>Generic error in case fetching the list of branches fails.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">branches_error</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="s2">&quot;Unable to load branch list: &lt;%=msg%&gt;&quot;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <h1>Adding Commands to the Console</h1>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p><section id='cmd.user'/></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <h2>user [ username ]</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>The <code>user</code> command is used to display information about the current user or switch between github users.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">setCommandHandler</span><span class="p">(</span><span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p><code>exec</code> handles the execution of the command.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">exec</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">cmd</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p>Given no arguments, it renders information about the current user, using the data fetched at user initialization.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">args</span> <span class="o">||</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">user</span><span class="p">({</span><span class="nx">user</span><span class="o">:</span> <span class="nx">_self</span><span class="p">.</span><span class="nx">user</span><span class="p">}));</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">username</span> <span class="o">=</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span></pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <p>Given an argument (assumed to be a username), it calls <code>setUser</code> to fetch the specified user and repository
information.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">return</span> <span class="nx">setUser</span><span class="p">(</span><span class="nx">username</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span>
          <span class="kd">function</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">user_error</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span> <span class="nx">username</span><span class="p">,</span> <span class="nx">msg</span><span class="o">:</span> <span class="nx">msg</span><span class="p">}));</span>
          <span class="p">},</span>
          <span class="kd">function</span><span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">user</span><span class="p">({</span><span class="nx">user</span><span class="o">:</span> <span class="nx">user</span><span class="p">}));</span>
          <span class="p">}</span>
        <span class="p">);</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p><code>user</code> has no completion handler, since the userbase of github is quite large and creating a search based
completion handler is beyond the scope of this tutorial implementation.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p><section id='cmd.repo'/></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <h2>repo [ -l | reponame ]</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <p>The <code>repo</code> command is used to display information about the current repo or switch to. It</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">setCommandHandler</span><span class="p">(</span><span class="s2">&quot;repo&quot;</span><span class="p">,</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <p><code>exec</code> handles the execution of the command.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">exec</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">cmd</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <p>Given no arguments, it renders information about the current repo.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">args</span> <span class="o">||</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">repo</span><span class="p">({</span><span class="nx">repo</span><span class="o">:</span> <span class="nx">_self</span><span class="p">.</span><span class="nx">repo</span><span class="p">}));</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span></pre></div>             </td>           </tr>                               <tr id="section-45">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-45">&#182;</a>               </div>               <p>Given the argument <code>-l</code>, it lists all repos for the current user. This information was fetched at user
initialization</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span><span class="p">(</span><span class="nx">name</span> <span class="o">===</span> <span class="s1">&#39;-l&#39;</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">repos</span><span class="p">({</span><span class="nx">repos</span><span class="o">:</span> <span class="nx">_self</span><span class="p">.</span><span class="nx">repos</span><span class="p">}));</span>
        <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-46">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-46">&#182;</a>               </div>               <p>Otherwise, the argument is assumed to a repo name, which <code>getRepo</code> uses to fetch the repository's information
from the data in <code>_self.repos</code>, if possible.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">var</span> <span class="nx">repo</span> <span class="o">=</span> <span class="nx">getRepo</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">_self</span><span class="p">.</span><span class="nx">repos</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-47">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-47">&#182;</a>               </div>               <p>If there is no matching repo, it renders an error.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">repo</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">repo_error</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">msg</span><span class="o">:</span> <span class="s1">&#39;no such repo&#39;</span><span class="p">}));</span>
        <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-48">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-48">&#182;</a>               </div>               <p>Given a valid repo, <code>setRepo</code> initializes the repo (i.e. fetching the root directory) and renders the repo
information.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">return</span> <span class="nx">setRepo</span><span class="p">(</span><span class="nx">repo</span><span class="p">,</span>
          <span class="kd">function</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">repo_error</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">msg</span><span class="o">:</span> <span class="nx">msg</span><span class="p">}));</span>
          <span class="p">},</span>
          <span class="kd">function</span><span class="p">(</span><span class="nx">repo</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">repo</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">repo_not_found</span><span class="p">({</span><span class="nx">repo</span><span class="o">:</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">user</span><span class="o">:</span> <span class="nx">_self</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">login</span><span class="p">}));</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">repo</span><span class="p">({</span><span class="nx">repo</span><span class="o">:</span> <span class="nx">_self</span><span class="p">.</span><span class="nx">repo</span><span class="p">}));</span>
          <span class="p">}</span>
        <span class="p">);</span>
      <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-49">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-49">&#182;</a>               </div>               <p><code>completion</code> uses <code>_self.repo</code> and <code>Josh.Shell.bestMatch</code> to try and match the partial information to the possible
matching repositories.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">completion</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">cmd</span><span class="p">,</span> <span class="nx">arg</span><span class="p">,</span> <span class="nx">line</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">callback</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">bestMatch</span><span class="p">(</span><span class="nx">arg</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">repos</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">repo</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">repo</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
        <span class="p">})));</span>
      <span class="p">}</span>
    <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-50">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-50">&#182;</a>               </div>               <p><section id='cmd.branch'/></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-51">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-51">&#182;</a>               </div>               <h2>branch [ -l | branchname ]</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-52">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-52">&#182;</a>               </div>               <p>The <code>branch</code> command is used to switch or list branches for the current repository.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">setCommandHandler</span><span class="p">(</span><span class="s2">&quot;branch&quot;</span><span class="p">,</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-53">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-53">&#182;</a>               </div>               <p><code>exec</code> handles the execution of the command.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">exec</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">cmd</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-54">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-54">&#182;</a>               </div>               <p>Given no arguments, it simply returns the current branch, which will be rendered by the shell.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">args</span> <span class="o">||</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">branch</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">branch</span> <span class="o">=</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span></pre></div>             </td>           </tr>                               <tr id="section-55">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-55">&#182;</a>               </div>               <p>Given the argument <code>-l</code>, it lists all branches for the current repo. This information is lazily
initialized via <code>ensureBranches</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span><span class="p">(</span><span class="nx">branch</span> <span class="o">===</span> <span class="s1">&#39;-l&#39;</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">ensureBranches</span><span class="p">(</span>
            <span class="kd">function</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">callback</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">branches_error</span><span class="p">({</span><span class="nx">msg</span><span class="o">:</span> <span class="nx">msg</span><span class="p">}));</span>
            <span class="p">},</span>
            <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
              <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">branches</span><span class="p">({</span><span class="nx">branches</span><span class="o">:</span> <span class="nx">_self</span><span class="p">.</span><span class="nx">branches</span><span class="p">}));</span>
            <span class="p">}</span>
          <span class="p">);</span>
        <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-56">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-56">&#182;</a>               </div>               <p>Owherwise, the current branch is switched by fetching the root directory for the new branch, and on success,
setting <code>_self.branch</code> and setting the current pathandler node to the root directory fetched.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">return</span> <span class="nx">getDir</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">repo</span><span class="p">.</span><span class="nx">full_name</span><span class="p">,</span> <span class="nx">branch</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">branch_error</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span> <span class="nx">branch</span><span class="p">,</span> <span class="nx">msg</span><span class="o">:</span> <span class="s2">&quot;unable to load root directory for branch&quot;</span><span class="p">}));</span>
          <span class="p">}</span>
          <span class="nx">_self</span><span class="p">.</span><span class="nx">branch</span> <span class="o">=</span> <span class="nx">branch</span><span class="p">;</span>
          <span class="nx">_self</span><span class="p">.</span><span class="nx">pathhandler</span><span class="p">.</span><span class="nx">current</span> <span class="o">=</span> <span class="nx">node</span><span class="p">;</span>
          <span class="nx">_self</span><span class="p">.</span><span class="nx">root</span> <span class="o">=</span> <span class="nx">node</span><span class="p">;</span>
          <span class="nx">callback</span><span class="p">();</span>
        <span class="p">});</span>
      <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-57">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-57">&#182;</a>               </div>               <p><code>completion</code> handles <code>TAB</code> completion on a partial branch name. The list of possible branches is once again
lazily initialized via <code>ensureBranches</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">completion</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">cmd</span><span class="p">,</span> <span class="nx">arg</span><span class="p">,</span> <span class="nx">line</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">ensureBranches</span><span class="p">(</span>
          <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">();</span>
          <span class="p">},</span>
          <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">callback</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">bestMatch</span><span class="p">(</span><span class="nx">arg</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">branches</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">branch</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">return</span> <span class="nx">branch</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
            <span class="p">})));</span>
          <span class="p">}</span>
        <span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-58">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-58">&#182;</a>               </div>               <p><section id='onNewPrompt'/></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-59">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-59">&#182;</a>               </div>               <p>This attaches a custom prompt render to the shell.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">onNewPrompt</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">callback</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">prompt</span><span class="p">({</span><span class="nx">self</span><span class="o">:</span> <span class="nx">_self</span><span class="p">,</span> <span class="nx">node</span><span class="o">:</span> <span class="nx">_self</span><span class="p">.</span><span class="nx">pathhandler</span><span class="p">.</span><span class="nx">current</span><span class="p">}));</span>
    <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-60">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-60">&#182;</a>               </div>               <h1>Wiring up PathHandler</h1>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-61">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-61">&#182;</a>               </div>               <p><section id='getNode'/></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-62">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-62">&#182;</a>               </div>               <h2>getNode</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-63">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-63">&#182;</a>               </div>               <p><code>getNode</code> is required by <code>Josh.PathHandler</code> to provide filesystem behavior. Given a path, it is expected to return
a pathnode or null;</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_self</span><span class="p">.</span><span class="nx">pathhandler</span><span class="p">.</span><span class="nx">getNode</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">_console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;looking for node at: &quot;</span> <span class="o">+</span> <span class="nx">path</span><span class="p">);</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">pathhandler</span><span class="p">.</span><span class="nx">current</span><span class="p">);</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-64">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-64">&#182;</a>               </div>               <p><code>buildAbsolutePath</code> is called recursively to turn <code>path</code> into an absolute path that can be resolved against the
github API with <code>getDir</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">buildAbsolutePath</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">_self</span><span class="p">.</span><span class="nx">pathhandler</span><span class="p">.</span><span class="nx">current</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">absPath</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">_console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;path to fetch: &quot;</span> <span class="o">+</span> <span class="nx">absPath</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">getDir</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">repo</span><span class="p">.</span><span class="nx">full_name</span><span class="p">,</span> <span class="nx">_self</span><span class="p">.</span><span class="nx">branch</span><span class="p">,</span> <span class="nx">absPath</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-65">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-65">&#182;</a>               </div>               <p><section id='getChildNodes'/></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-66">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-66">&#182;</a>               </div>               <h2>getChildNodes</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-67">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-67">&#182;</a>               </div>               <p><code>getChildNodes</code> is the second function implementation required for <code>Josh.PathHandler</code>. Given a pathnode, it returns
a list of child pathnodes. This is used by <code>Tab</code> completion to resolve a partial path, after first resolving the
nearest parent node using `getNode</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_self</span><span class="p">.</span><span class="nx">pathhandler</span><span class="p">.</span><span class="nx">getChildNodes</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-68">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-68">&#182;</a>               </div>               <p>If the given node is a file node, no further work is required.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">isfile</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">_console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;it&#39;s a file, no children&quot;</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">callback</span><span class="p">();</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-69">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-69">&#182;</a>               </div>               <p>Otherwise, if the child nodes have already been initialized, which is done lazily, return them.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">children</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">_console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;got children, let&#39;s turn them into nodes&quot;</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">makeNodes</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">children</span><span class="p">));</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-70">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-70">&#182;</a>               </div>               <p>Finally, use <code>getDir</code> to fetch and populate the child nodes.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">_console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;no children, fetch them&quot;</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">getDir</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">repo</span><span class="p">.</span><span class="nx">full_name</span><span class="p">,</span> <span class="nx">_self</span><span class="p">.</span><span class="nx">branch</span><span class="p">,</span> <span class="nx">node</span><span class="p">.</span><span class="nx">path</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">detailNode</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">node</span><span class="p">.</span><span class="nx">children</span> <span class="o">=</span> <span class="nx">detailNode</span><span class="p">.</span><span class="nx">children</span><span class="p">;</span>
        <span class="nx">callback</span><span class="p">(</span><span class="nx">makeNodes</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">children</span><span class="p">));</span>
      <span class="p">});</span>
    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-71">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-71">&#182;</a>               </div>               <h1>Supporting Functions</h1>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-72">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-72">&#182;</a>               </div>               <p><section id='get'/></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-73">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-73">&#182;</a>               </div>               <h2>get</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-74">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-74">&#182;</a>               </div>               <p>This function is responsible for all API requests, given a partial API path, <code>resource</code>, and an query argument object,
<code>args</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">get</span><span class="p">(</span><span class="nx">resource</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">_self</span><span class="p">.</span><span class="nx">api</span> <span class="o">+</span> <span class="nx">resource</span><span class="p">;</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">url</span> <span class="o">+=</span> <span class="s2">&quot;?&quot;</span> <span class="o">+</span> <span class="nx">_</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">args</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">k</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">k</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">+</span> <span class="nx">v</span><span class="p">;</span>
        <span class="p">}).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="nx">_console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;fetching: &quot;</span> <span class="o">+</span> <span class="nx">url</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">url</span><span class="o">:</span> <span class="nx">url</span><span class="p">,</span>
        <span class="nx">dataType</span><span class="o">:</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span>
        <span class="nx">xhrFields</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">withCredentials</span><span class="o">:</span> <span class="kc">true</span>
        <span class="p">}</span>
      <span class="p">};</span>
      <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">(</span><span class="nx">request</span><span class="p">).</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">,</span><span class="nx">status</span><span class="p">,</span><span class="nx">xhr</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-75">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-75">&#182;</a>               </div>               <p>Every response from the API includes rate limiting headers, as well as an indicator injected by the API proxy
whether the request was done with authentication. Both are used to display request rate information and a
link to authenticate, if required.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">var</span> <span class="nx">ratelimit</span> <span class="o">=</span> <span class="p">{</span>
          <span class="nx">remaining</span><span class="o">:</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">getResponseHeader</span><span class="p">(</span><span class="s2">&quot;X-RateLimit-Remaining&quot;</span><span class="p">)),</span>
          <span class="nx">limit</span><span class="o">:</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">getResponseHeader</span><span class="p">(</span><span class="s2">&quot;X-RateLimit-Limit&quot;</span><span class="p">)),</span>
          <span class="nx">authenticated</span><span class="o">:</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">getResponseHeader</span><span class="p">(</span><span class="s1">&#39;Authenticated&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;true&#39;</span>
        <span class="p">};</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#ratelimit&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">templates</span><span class="p">.</span><span class="nx">rateLimitTemplate</span><span class="p">(</span><span class="nx">ratelimit</span><span class="p">));</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">ratelimit</span><span class="p">.</span><span class="nx">remaining</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Whoops, you&#39;ve hit the github rate limit. You&#39;ll need to authenticate to continue&quot;</span><span class="p">);</span>
          <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">deactivate</span><span class="p">();</span>
          <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-76">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-76">&#182;</a>               </div>               <p>For simplicity, this tutorial trivially deals with request failures by just returning null from this function
via the callback.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span><span class="p">(</span><span class="nx">status</span> <span class="o">!==</span> <span class="s1">&#39;success&#39;</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">callback</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
      <span class="p">})</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-77">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-77">&#182;</a>               </div>               <p><section id='ensureBranches'/></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-78">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-78">&#182;</a>               </div>               <h2>ensureBranches</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-79">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-79">&#182;</a>               </div>               <p>This function lazily fetches the branches for the current repo from the API.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">ensureBranches</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">get</span><span class="p">(</span><span class="s2">&quot;repos/&quot;</span> <span class="o">+</span> <span class="nx">_self</span><span class="p">.</span><span class="nx">repo</span><span class="p">.</span><span class="nx">full_name</span> <span class="o">+</span> <span class="s2">&quot;/branches&quot;</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">branches</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">branches</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">err</span><span class="p">(</span><span class="s2">&quot;api request failed to return branch list&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">_self</span><span class="p">.</span><span class="nx">branches</span> <span class="o">=</span> <span class="nx">branches</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">callback</span><span class="p">();</span>
      <span class="p">});</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-80">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-80">&#182;</a>               </div>               <p><section id='setUser'/></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-81">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-81">&#182;</a>               </div>               <h2>setUser</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-82">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-82">&#182;</a>               </div>               <p>This function fetches the specified user and initializes a repository to the provided value (which may be null).
one fetched by <code>initialzeRepos</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">setUser</span><span class="p">(</span><span class="nx">user_name</span><span class="p">,</span> <span class="nx">repo_name</span><span class="p">,</span> <span class="nx">err</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">user</span> <span class="o">&amp;&amp;</span> <span class="nx">_self</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">login</span> <span class="o">===</span> <span class="nx">user_name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">user</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nx">get</span><span class="p">(</span><span class="s2">&quot;users/&quot;</span> <span class="o">+</span> <span class="nx">user_name</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">err</span><span class="p">(</span><span class="s2">&quot;no such user&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">initializeRepos</span><span class="p">(</span><span class="nx">user</span><span class="p">,</span> <span class="nx">repo_name</span><span class="p">,</span> <span class="nx">err</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">repo</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">_self</span><span class="p">.</span><span class="nx">user</span> <span class="o">=</span> <span class="nx">user</span><span class="p">;</span>
          <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">user</span><span class="p">);</span>
        <span class="p">});</span>
      <span class="p">});</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-83">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-83">&#182;</a>               </div>               <p><section id='initializeRepos'/></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-84">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-84">&#182;</a>               </div>               <h2>initalizeRepos</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-85">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-85">&#182;</a>               </div>               <p>This function first fetches all repos for the given user from the API and then sets the current repo to the provided
value (which may be null).</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">initializeRepos</span><span class="p">(</span><span class="nx">user</span><span class="p">,</span> <span class="nx">repo_name</span><span class="p">,</span> <span class="nx">err</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">getRepos</span><span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">login</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">repos</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">repo</span> <span class="o">=</span> <span class="nx">getRepo</span><span class="p">(</span><span class="nx">repo_name</span><span class="p">,</span> <span class="nx">repos</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">repo</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">err</span><span class="p">(</span><span class="s2">&quot;user has no repositories&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">setRepo</span><span class="p">(</span><span class="nx">repo</span><span class="p">,</span> <span class="nx">err</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">repo</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">_self</span><span class="p">.</span><span class="nx">repos</span> <span class="o">=</span> <span class="nx">repos</span><span class="p">;</span>
          <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">repo</span><span class="p">);</span>
        <span class="p">});</span>
      <span class="p">});</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-86">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-86">&#182;</a>               </div>               <p><section id='getDir'/></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-87">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-87">&#182;</a>               </div>               <h2>getDir</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-88">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-88">&#182;</a>               </div>               <p>This function function fetches the directory listing for a path on a given repo and branch.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">getDir</span><span class="p">(</span><span class="nx">repo_full_name</span><span class="p">,</span> <span class="nx">branch</span><span class="p">,</span> <span class="nx">path</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-89">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-89">&#182;</a>               </div>               <p>Although paths in the internal representation may have a trailing <code>/</code>, it has to be removed before using it
as the argument for an API request.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span><span class="p">(</span><span class="nx">path</span> <span class="o">&amp;&amp;</span> <span class="nx">path</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">path</span><span class="p">[</span><span class="nx">path</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">path</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">path</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="nx">get</span><span class="p">(</span><span class="s2">&quot;repos/&quot;</span> <span class="o">+</span> <span class="nx">repo_full_name</span> <span class="o">+</span> <span class="s2">&quot;/contents&quot;</span> <span class="o">+</span> <span class="nx">path</span><span class="p">,</span> <span class="p">{</span><span class="nx">ref</span><span class="o">:</span> <span class="nx">branch</span><span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-90">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-90">&#182;</a>               </div>               <p>The API call may return either an array, indicating that the path was a directory, or an object. Since only
are stored as pathnodes, retrieving anything but an array returns null via the callback.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="o">!==</span> <span class="s1">&#39;[object Array]&#39;</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">_console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;path &#39;&quot;</span> <span class="o">+</span> <span class="nx">path</span> <span class="o">+</span> <span class="s2">&quot;&#39; was a file&quot;</span><span class="p">);</span>
          <span class="k">return</span> <span class="nx">callback</span><span class="p">();</span>
        <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-91">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-91">&#182;</a>               </div>               <p>Given a directory listing, i.e. array, the current directory node is created and the API return value captured
as children so that they can later be transformed into child pathnodes, if required.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="p">{</span>
          <span class="nx">name</span><span class="o">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">last</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">x</span><span class="p">;</span>
          <span class="p">}))</span> <span class="o">||</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
          <span class="nx">path</span><span class="o">:</span> <span class="nx">path</span><span class="p">,</span>
          <span class="nx">children</span><span class="o">:</span> <span class="nx">data</span>
        <span class="p">};</span>
        <span class="nx">_console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;got node at: &quot;</span> <span class="o">+</span> <span class="nx">node</span><span class="p">.</span><span class="nx">path</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-92">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-92">&#182;</a>               </div>               <p><section id='getRepos'/></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-93">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-93">&#182;</a>               </div>               <h2>getRepos</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-94">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-94">&#182;</a>               </div>               <p>This function fetches all repositories for a given user.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">getRepos</span><span class="p">(</span><span class="nx">userLogin</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">get</span><span class="p">(</span><span class="s2">&quot;users/&quot;</span> <span class="o">+</span> <span class="nx">userLogin</span> <span class="o">+</span> <span class="s2">&quot;/repos&quot;</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">callback</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-95">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-95">&#182;</a>               </div>               <p><section id='getRepo'/></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-96">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-96">&#182;</a>               </div>               <h2>getRepo</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-97">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-97">&#182;</a>               </div>               <p>This function tries to match a repository from the given list of known repositories. Should <code>repo_name</code> be null,
the first repository in <code>repos</code> is returned.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">getRepo</span><span class="p">(</span><span class="nx">repo_name</span><span class="p">,</span> <span class="nx">repos</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">repos</span> <span class="o">||</span> <span class="nx">repos</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="kd">var</span> <span class="nx">repo</span><span class="p">;</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">repo_name</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">repo</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">repos</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">repo</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">repo</span><span class="p">.</span><span class="nx">name</span> <span class="o">===</span> <span class="nx">repo_name</span><span class="p">;</span>
        <span class="p">});</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">repo</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">callback</span><span class="p">();</span>
        <span class="p">}</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">repo</span> <span class="o">=</span> <span class="nx">repos</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nx">repo</span><span class="p">;</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-98">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-98">&#182;</a>               </div>               <p><section id='setRepo'/></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-99">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-99">&#182;</a>               </div>               <h2>setRepo</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-100">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-100">&#182;</a>               </div>               <p>This function fetches the root directory for the specified repository and initializes the current repository
state.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">setRepo</span><span class="p">(</span><span class="nx">repo</span><span class="p">,</span> <span class="nx">err</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">getDir</span><span class="p">(</span><span class="nx">repo</span><span class="p">.</span><span class="nx">full_name</span><span class="p">,</span> <span class="nx">repo</span><span class="p">.</span><span class="nx">default_branch</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">err</span><span class="p">(</span><span class="s2">&quot;could not initialize root directory of repository &#39;&quot;</span> <span class="o">+</span> <span class="nx">repo</span><span class="p">.</span><span class="nx">full_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">_console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;setting repo to &#39;&quot;</span> <span class="o">+</span> <span class="nx">repo</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">);</span>
        <span class="nx">_self</span><span class="p">.</span><span class="nx">repo</span> <span class="o">=</span> <span class="nx">repo</span><span class="p">;</span>
        <span class="nx">_self</span><span class="p">.</span><span class="nx">branch</span> <span class="o">=</span> <span class="nx">repo</span><span class="p">.</span><span class="nx">default_branch</span><span class="p">;</span>
        <span class="nx">_self</span><span class="p">.</span><span class="nx">pathhandler</span><span class="p">.</span><span class="nx">current</span> <span class="o">=</span> <span class="nx">node</span><span class="p">;</span>
        <span class="nx">_self</span><span class="p">.</span><span class="nx">root</span> <span class="o">=</span> <span class="nx">node</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">repo</span><span class="p">);</span>
      <span class="p">});</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-101">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-101">&#182;</a>               </div>               <p><section id='buildAbsolutePath'/></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-102">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-102">&#182;</a>               </div>               <h2>buildAbsolutePath</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-103">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-103">&#182;</a>               </div>               <p>This function resolves a path to an absolute path given a current node.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">buildAbsolutePath</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">current</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">_console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;resolving path: &quot;</span><span class="o">+</span><span class="nx">path</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">parts</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-104">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-104">&#182;</a>               </div>               <p>If the first part of the path is <code>..</code>, <code>current</code> is used to determine the parent path and construct an absolute
path from the combination of the parent path and the remainder of <code>path</code>. Since this compoint path may still
contain <code>.</code> or <code>..</code>, path operators that the github API does not understand, the resulting value is fed back
into <code>buildAbsolutePath</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span><span class="p">(</span><span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;..&#39;</span> <span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">parentParts</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">current</span><span class="p">.</span><span class="nx">path</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nx">x</span><span class="p">;</span>
        <span class="p">});</span>
        <span class="nx">path</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nx">parentParts</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">parentParts</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nx">parts</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">buildAbsolutePath</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">_self</span><span class="p">.</span><span class="nx">root</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-105">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-105">&#182;</a>               </div>               <p>If the first parht of the path is either a <code>.</code> or not empty (i.e. the path had started with a <code>/</code>, the path must
be relative and an absolute path can be constructed by combining the path and <code>current</code>. Once again, the value
isfed back into <code>buildAbsolutePath</code> for final resolution.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span><span class="p">(</span><span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;.&#39;</span> <span class="o">||</span> <span class="nx">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">path</span> <span class="o">=</span> <span class="nx">current</span><span class="p">.</span><span class="nx">path</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="nx">path</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">buildAbsolutePath</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">_self</span><span class="p">.</span><span class="nx">root</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-106">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-106">&#182;</a>               </div>               <p>At this point the path looks absolute, but all <code>.</code> and <code>..</code> mentions need to removed and resolved before a truly
absolute path can be returned.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">resolved</span> <span class="o">=</span> <span class="p">[];</span>
      <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">parts</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">x</span> <span class="o">===</span> <span class="s1">&#39;..&#39;</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">resolved</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">resolved</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">});</span>
      <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">resolved</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">));</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-107">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-107">&#182;</a>               </div>               <p><section id='makeNodes'/></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-108">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-108">&#182;</a>               </div>               <h2>makeNodes</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-109">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-109">&#182;</a>               </div>               <p>This method builds child pathnodes from the directory information returned by getDir.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">makeNodes</span><span class="p">(</span><span class="nx">children</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">children</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
          <span class="nx">name</span><span class="o">:</span> <span class="nx">node</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span>
          <span class="nx">path</span><span class="o">:</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nx">node</span><span class="p">.</span><span class="nx">path</span><span class="p">,</span>
          <span class="nx">isFile</span><span class="o">:</span> <span class="nx">node</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;file&#39;</span>
        <span class="p">};</span>
      <span class="p">});</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-110">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-110">&#182;</a>               </div>               <h1>UI setup and initialization</h1>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-111">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-111">&#182;</a>               </div>               <p><section id='initializationError'/></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-112">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-112">&#182;</a>               </div>               <h2>initializationError</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-113">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-113">&#182;</a>               </div>               <p>This function is a lazy way with giving up if some request failed during intialization, forcing the user
to reload to retry.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">initializationError</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">_console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;[&quot;</span> <span class="o">+</span> <span class="nx">context</span> <span class="o">+</span> <span class="s2">&quot;] failed to initialize: &quot;</span> <span class="o">+</span> <span class="nx">msg</span><span class="p">);</span>
      <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;unable to initialize shell. Encountered a problem talking to github api. Try reloading the page&quot;</span><span class="p">);</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-114">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-114">&#182;</a>               </div>               <p><section id='initializeUI'/></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-115">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-115">&#182;</a>               </div>               <h2>intializeUI</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-116">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-116">&#182;</a>               </div>               <p>After a current user and repo have been set, this function initializes the UI state to allow the shell to be
shown and hidden.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">initializeUI</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">_console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;activating&quot;</span><span class="p">);</span>
      <span class="kd">var</span> <span class="nx">$consolePanel</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#shell-container&#39;</span><span class="p">);</span>
      <span class="nx">$consolePanel</span><span class="p">.</span><span class="nx">resizable</span><span class="p">({</span> <span class="nx">handles</span><span class="o">:</span> <span class="s2">&quot;s&quot;</span><span class="p">});</span>
      <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">keypress</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">isActive</span><span class="p">())</span> <span class="p">{</span>
          <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">keyCode</span> <span class="o">==</span> <span class="mi">126</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
          <span class="nx">activateAndShow</span><span class="p">();</span>
        <span class="p">}</span>
      <span class="p">});</span>
      <span class="kd">function</span> <span class="nx">activateAndShow</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">activate</span><span class="p">();</span>
        <span class="nx">$consolePanel</span><span class="p">.</span><span class="nx">slideDown</span><span class="p">();</span>
        <span class="nx">$consolePanel</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
      <span class="p">}</span>

      <span class="kd">function</span> <span class="nx">hideAndDeactivate</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">deactivate</span><span class="p">();</span>
        <span class="nx">$consolePanel</span><span class="p">.</span><span class="nx">slideUp</span><span class="p">();</span>
        <span class="nx">$consolePanel</span><span class="p">.</span><span class="nx">blur</span><span class="p">();</span>
      <span class="p">}</span>

      <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">onEOT</span><span class="p">(</span><span class="nx">hideAndDeactivate</span><span class="p">);</span>
      <span class="nx">_self</span><span class="p">.</span><span class="nx">shell</span><span class="p">.</span><span class="nx">onCancel</span><span class="p">(</span><span class="nx">hideAndDeactivate</span><span class="p">);</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-117">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-117">&#182;</a>               </div>               <p><section id='document.ready'/></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-118">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-118">&#182;</a>               </div>               <p>On document ready, the default user and repo are loaded from the API before the UI can complete initialization.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">setUser</span><span class="p">(</span><span class="s2">&quot;sdether&quot;</span><span class="p">,</span> <span class="s2">&quot;josh.js&quot;</span><span class="p">,</span>
        <span class="kd">function</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">initializationError</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="nx">msg</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="nx">initializeUI</span>
      <span class="p">);</span>
    <span class="p">});</span>
  <span class="p">})(</span><span class="nx">root</span><span class="p">,</span> <span class="nx">$</span><span class="p">,</span> <span class="nx">_</span><span class="p">);</span>
<span class="p">})(</span><span class="k">this</span><span class="p">,</span> <span class="nx">$</span><span class="p">,</span> <span class="nx">_</span><span class="p">);</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-39420675-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body> </html>